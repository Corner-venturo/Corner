#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” åŸ·è¡Œ pre-commit ä»£ç¢¼å“è³ªæª¢æŸ¥..."
echo "================================"

# TypeScript é¡å‹æª¢æŸ¥
echo ""
echo "ğŸ”§ åŸ·è¡Œ TypeScript é¡å‹æª¢æŸ¥..."
if ! npm run type-check --silent; then
  echo "âŒ TypeScript é¡å‹æª¢æŸ¥å¤±æ•—ï¼"
  exit 1
fi

# å–®å…ƒæ¸¬è©¦
echo ""
echo "ğŸ§ª åŸ·è¡Œå–®å…ƒæ¸¬è©¦..."
if ! npx vitest run --silent; then
  echo "âŒ å–®å…ƒæ¸¬è©¦å¤±æ•—ï¼"
  exit 1
fi

# ESLint æª¢æŸ¥
echo ""
echo "ğŸ“‹ åŸ·è¡Œ ESLint æª¢æŸ¥..."
if ! npm run lint --silent; then
  echo "âŒ ESLint æª¢æŸ¥å¤±æ•—ï¼"
  echo "ğŸ’¡ æç¤ºï¼šåŸ·è¡Œ 'npm run lint' æŸ¥çœ‹è©³ç´°éŒ¯èª¤"
  exit 1
fi

echo ""
echo "================================"
echo "âœ… æ‰€æœ‰ pre-commit æª¢æŸ¥é€šéï¼"
echo ""
