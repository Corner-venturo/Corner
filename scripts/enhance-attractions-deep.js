const { createClient } = require('@supabase/supabase-js');

const supabase = createClient(
  'https://pfqvdacxowpgfamuvnsn.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBmcXZkYWN4b3dwZ2ZhbXV2bnNuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxMDgzMjAsImV4cCI6MjA3NDY4NDMyMH0.LIMG0qmHixTPcbdzJrh4h0yTp8mh3FlggeZ6Bi_NwtI'
);

// 深度景點資料 - 包含完整實用資訊
const deepAttractions = [
  // ============================================
  // 日本 - 京都深度景點
  // ============================================
  {
    name: "伏見稻荷大社",
    updates: {
      description: "日本約三萬座稻荷神社的總本社，以綿延4公里、超過萬座朱紅色鳥居「千本鳥居」聞名於世。稻荷大神自711年鎮座於稻荷山，是掌管五穀豐收、商業繁盛的神明。神社24小時開放，夜間走訪別有一番神秘氛圍。攀登至山頂約需2-3小時，沿途可見眾多小型神社和茶屋。",
      duration_minutes: 120,
      opening_hours: "24小時開放（主殿境內自由參拜）",
      tags: ["世界遺產候補", "千本鳥居", "稻荷神", "夜間參拜", "登山健行", "免費入場", "攝影聖地", "狐狸神使"],
      notes: "建議清晨或傍晚前往避開人潮。登山全程約4km，穿著舒適鞋子。山頂有茶屋可休息。JR稻荷站出站即達，交通便利。"
    }
  },
  {
    name: "金閣寺",
    updates: {
      description: "正式名稱為「鹿苑寺」，建於1397年，原為室町幕府三代將軍足利義滿的別墅。金閣三層樓閣全部貼滿金箔，倒映在鏡湖池中的景象堪稱絕景。1950年曾遭僧侶縱火焚毀（三島由紀夫小說《金閣寺》即以此為題材），現存建築為1955年重建。",
      duration_minutes: 60,
      opening_hours: "9:00-17:00（全年無休）",
      tags: ["世界遺產", "金箔建築", "室町時代", "足利義滿", "鏡湖池", "三島由紀夫", "必訪景點", "庭園"],
      notes: "門票400日圓，附贈御守護符。建議早上開門時前往，光線最美且人較少。秋季楓葉、冬季雪景尤其絕美。附近可順遊龍安寺、仁和寺。"
    }
  },
  {
    name: "清水寺",
    updates: {
      description: "建於778年的古剎，主堂「清水舞台」由139根巨大櫸木柱支撐，懸空於斷崖之上，完全未使用一根釘子的傳統建築工法令人驚嘆。「從清水舞台跳下」是日語中形容破釜沉舟決心的諺語。寺內音羽瀑布的三道泉水分別代表學業、戀愛、長壽，選擇其一飲用可獲得靈驗。",
      duration_minutes: 90,
      opening_hours: "6:00-18:00（季節性延長至21:30夜間參拜）",
      tags: ["世界遺產", "清水舞台", "懸崖建築", "音羽瀑布", "夜間參拜", "楓葉名所", "櫻花名所", "二年坂三年坂"],
      notes: "門票400日圓。春秋有夜間特別參拜。從參道二年坂、三年坂步行上山約15分鐘，沿途商店林立。建議搭配祇園、八坂神社一日遊。"
    }
  },
  {
    name: "嵐山竹林",
    updates: {
      description: "嵯峨野竹林小徑是京都最具代表性的景觀之一，兩旁高聳入天的孟宗竹形成天然隧道，微風吹過竹葉沙沙作響，被選為「日本百大音風景」。全長約400公尺，連接野宮神社至天龍寺北門。竹林在清晨時分光線最為夢幻，且遊客較少。",
      duration_minutes: 30,
      opening_hours: "24小時開放（免費）",
      tags: ["竹林小徑", "嵯峨野", "攝影聖地", "日本百大音風景", "清晨推薦", "野宮神社", "免費景點", "自然風景"],
      notes: "免費開放。強烈建議清晨6-7點前往，可獨享無人竹林。可搭配渡月橋、天龍寺、野宮神社一起遊覽。JR嵯峨嵐山站步行10分鐘。"
    }
  },
  {
    name: "錦市場",
    updates: {
      description: "擁有400年歷史的「京都廚房」，全長約390公尺的商店街聚集130多家店鋪，販售京野菜、漬物、生魚片、乾貨、和菓子等京都特產。這裡是體驗京都飲食文化的最佳場所，許多店家提供試吃和現做小吃，可以邊走邊吃。",
      duration_minutes: 90,
      opening_hours: "大多數店家9:00-17:00（週三部分公休）",
      tags: ["傳統市場", "京都廚房", "400年歷史", "京野菜", "漬物", "邊走邊吃", "美食天堂", "伴手禮"],
      notes: "週三部分店家休息，建議避開。必吃：玉子燒、生牡蠣、豆乳甜甜圈、抹茶冰淇淋。位於四條通附近，可結合祇園行程。禁止邊走邊吃的區域請注意標示。"
    }
  },
  {
    name: "祇園",
    updates: {
      description: "京都最著名的花街，至今仍保留傳統茶屋建築和藝妓文化。花見小路是祇園的主要街道，兩側是格子門的傳統町家，夜幕降臨後可能與趕赴宴席的舞妓、藝妓擦身而過。白川南通沿著白川河畔，柳樹成蔭，是欣賞京都古都風情的絕佳地點。",
      duration_minutes: 60,
      opening_hours: "24小時（街區開放）",
      tags: ["花街", "藝妓文化", "舞妓", "花見小路", "白川", "傳統建築", "夜景", "茶屋"],
      notes: "尊重隱私，請勿追逐或未經同意拍攝藝妓。私人區域禁止進入。傍晚17:00-19:00最有機會看到藝妓。附近有八坂神社、高台寺可順遊。"
    }
  },
  // ============================================
  // 日本 - 東京深度景點
  // ============================================
  {
    name: "淺草寺",
    updates: {
      description: "創建於628年的東京最古老寺廟，供奉觀世音菩薩。雷門的巨大紅燈籠是東京最具代表性的地標，高3.9公尺、重700公斤。仲見世通是日本最古老的商店街之一，長約250公尺，約90家店鋪販售各種傳統小吃和紀念品。每年約有3000萬人次參拜。",
      duration_minutes: 90,
      opening_hours: "境內24小時開放，主堂6:00-17:00（10-3月6:30起）",
      tags: ["東京最古老", "雷門", "仲見世通", "觀音菩薩", "雷門燈籠", "人形燒", "淺草文化", "和服體驗"],
      notes: "免費參拜。必吃：人形燒、雷米花、淺草炸肉餅。附近可租和服體驗。建議搭配晴空塔、隅田公園。新年初詣人潮達300萬，要有心理準備。"
    }
  },
  {
    name: "晴空塔",
    updates: {
      description: "2012年開業的東京新地標，高634公尺，是世界最高的自立式電波塔（以日本舊國名「武藏」諧音命名）。設有兩個展望台：天望甲板（350m）和天望回廊（450m），晴天可遠眺富士山。塔底的東京Solamachi商場有300多家店舖和水族館。",
      duration_minutes: 120,
      opening_hours: "8:00-22:00（最終入場21:00）",
      tags: ["世界最高塔", "東京地標", "634公尺", "展望台", "富士山", "夜景", "墨田水族館", "購物"],
      notes: "展望台票價：天望甲板2100日圓起，天望回廊加購1000日圓。建議網路預約指定時間票避免排隊。日落時分上塔可同時欣賞夕陽和夜景。晴天才看得到富士山。"
    }
  },
  {
    name: "築地場外市場",
    updates: {
      description: "雖然築地市場場內已於2018年遷移至豐洲，但場外市場仍保留約400家店舖，販售新鮮海產、玉子燒、乾貨、廚房用品等。這裡依然是品嚐最新鮮海鮮丼、壽司、生蠔的聖地，許多店家凌晨就開始營業，是體驗東京庶民美食文化的最佳地點。",
      duration_minutes: 120,
      opening_hours: "大多數5:00-14:00（週日、假日及部分週三休市）",
      tags: ["海鮮市場", "壽司", "海鮮丼", "玉子燒", "清晨美食", "壽司大", "大和壽司", "庶民美食"],
      notes: "建議清晨前往，新鮮度最佳且能避開人潮。週日休市。必吃：玉子燒、海鮮丼、生蠔。人氣壽司店需排隊1-2小時。從日比谷線築地站步行1分鐘。"
    }
  },
  {
    name: "明治神宮",
    updates: {
      description: "1920年為供奉明治天皇和昭憲皇太后而建的神社，佔地70萬平方公尺的森林是由全國各地獻納的10萬棵樹木人工造林而成，如今已成為東京都心的自然綠洲。參道入口的大鳥居是日本最大的木造鳥居，高12公尺，以1500年樹齡的台灣扁柏製成。",
      duration_minutes: 60,
      opening_hours: "日出至日落（依季節變動，約5:00-18:30）",
      tags: ["神社", "明治天皇", "森林浴", "大鳥居", "台灣扁柏", "原宿", "新年參拜", "婚禮"],
      notes: "免費參拜。每年新年參拜人數達300萬人，為日本第一。週末常有傳統神前婚禮舉行。從原宿站步行1分鐘。可搭配原宿、表參道購物。"
    }
  },
  {
    name: "澀谷十字路口",
    updates: {
      description: "世界最繁忙的行人十字路口，每次綠燈約有3000人同時穿越，一天超過50萬人次。當紅燈轉綠，五個方向的行人潮水般湧入路口的壯觀場面，成為東京最具代表性的都市景觀。最佳觀賞點是星巴克二樓和MAGNET by SHIBUYA109的展望台。",
      duration_minutes: 30,
      opening_hours: "24小時",
      tags: ["世界最繁忙", "都市景觀", "攝影聖地", "忠犬八公", "SHIBUYA109", "年輕文化", "觀景台", "星巴克"],
      notes: "免費觀賞。MAGNET by SHIBUYA109屋頂展望台需付費300日圓。忠犬八公銅像在車站八公口。附近有SHIBUYA109、Parco、東急百貨等購物中心。"
    }
  },
  {
    name: "新宿御苑",
    updates: {
      description: "佔地58.3公頃的皇室庭園，融合了日式迴遊式庭園、法式整形庭園和英式風景庭園三種風格。園內種植超過1000棵櫻花樹（約65品種），是東京最著名的賞櫻勝地。電影《言葉之庭》的取景地，雨天的日式庭園別有詩意。",
      duration_minutes: 90,
      opening_hours: "9:00-16:30（閉園17:30，週一休園）",
      tags: ["皇室庭園", "櫻花名所", "三種庭園風格", "言葉之庭", "新海誠", "賞楓", "溫室", "野餐"],
      notes: "門票500日圓。禁止攜帶酒類和遊樂器材。櫻花季（3月下旬-4月中旬）人潮洶湧，建議平日前往。新宿御苑前站、新宿三丁目站步行5分鐘。"
    }
  },
  // ============================================
  // 日本 - 大阪深度景點
  // ============================================
  {
    name: "大阪城",
    updates: {
      description: "1583年由豐臣秀吉建造，曾是日本歷史上規模最大的城堡。現存天守閣為1931年重建，內部設有博物館展示大阪歷史和豐臣秀吉生平。城郭周圍的西之丸庭園約有300棵櫻花樹，是大阪首屈一指的賞櫻名所。石垣上的巨石「蛸石」表面積約60平方公尺，重達130噸。",
      duration_minutes: 120,
      opening_hours: "9:00-17:00（入館至16:30，季節延長至19:00）",
      tags: ["豐臣秀吉", "日本名城", "博物館", "櫻花名所", "石垣", "天守閣", "西之丸庭園", "歷史"],
      notes: "天守閣門票600日圓。西之丸庭園另計200日圓（櫻花季350日圓）。建議搭配大阪城公園、JO-TERRACE商業設施。從大阪城公園站步行15分鐘。"
    }
  },
  {
    name: "道頓堀",
    updates: {
      description: "大阪最具代表性的觀光商圈，以巨大的固力果跑者霓虹燈招牌聞名。道頓堀川兩岸是美食激戰區，「吃到倒」（食い倒れ）是這裡的代名詞。必吃章魚燒、大阪燒、串炸等大阪名物，戎橋是拍攝固力果看板的最佳位置。夜晚霓虹燈閃爍，更顯繁華。",
      duration_minutes: 120,
      opening_hours: "店家約11:00-23:00，部分深夜營業",
      tags: ["固力果看板", "美食天堂", "章魚燒", "大阪燒", "串炸", "霓虹燈", "戎橋", "食い倒れ"],
      notes: "用餐尖峰時段需排隊。必吃：本家章魚燒（たこ焼き）、千房大阪燒、元祖串カツだるま。可搭配心齋橋購物。地鐵難波站、日本橋站步行5分鐘。"
    }
  },
  {
    name: "黑門市場",
    updates: {
      description: "有「大阪廚房」之稱的傳統市場，歷史超過180年，全長約580公尺，約有150家店鋪。這裡是專業料理人採購食材的地方，新鮮海產、河豚、和牛、水果應有盡有。近年來發展成觀光市場，許多店家提供現做料理可立即享用。",
      duration_minutes: 90,
      opening_hours: "9:00-18:00（各店不同，年末特別營業）",
      tags: ["大阪廚房", "海鮮市場", "河豚", "和牛", "水果", "現做料理", "黑門直擊", "年末採買"],
      notes: "必吃：現烤帝王蟹、黑鮪魚生魚片、和牛串、草莓。年末12/28-31是最熱鬧時期。部分店家現金交易。日本橋站步行2分鐘。"
    }
  },
  // ============================================
  // 韓國 - 首爾深度景點
  // ============================================
  {
    name: "景福宮",
    updates: {
      description: "建於1395年的朝鮮王朝正宮，是首爾五大宮闕中規模最大、歷史最悠久的宮殿。興禮門前每日舉行守門將交接儀式，重現朝鮮時代皇宮警備場景。穿著韓服入場可免費參觀，附近有大量韓服出租店。慶會樓和香遠亭是宮內最美的建築。",
      duration_minutes: 120,
      opening_hours: "9:00-18:00（3-10月至18:30，週二休館）",
      tags: ["朝鮮王朝", "五大宮", "守門將交接", "韓服免費入場", "慶會樓", "勤政殿", "光化門", "國立民俗博物館"],
      notes: "門票3000韓元，穿韓服免費。守門將交接10:00、14:00（雨天取消）。建議租韓服體驗，3-5小時約15000-30000韓元。可順遊北村韓屋村、三清洞。"
    }
  },
  {
    name: "明洞",
    updates: {
      description: "首爾最熱鬧的購物商圈，聚集超過2000家商店，從國際精品到韓國美妝品牌應有盡有。Olive Young、INNISFREE、ETUDE HOUSE等韓國美妝店比鄰而立，是韓國美妝愛好者的天堂。街頭小吃攤販林立，雞蛋糕、起司熱狗、草莓冰淇淋等美食琳瑯滿目。",
      duration_minutes: 180,
      opening_hours: "大多數店家10:30-22:00",
      tags: ["購物天堂", "韓國美妝", "明洞聖堂", "街頭小吃", "換匯", "退稅", "年輕潮流", "藥妝店"],
      notes: "換匯匯率好，現金購物更划算。退稅門檻3萬韓元起。必逛：Olive Young、LINE FRIENDS、KAKAO FRIENDS。街頭小吃約2000-5000韓元。地鐵明洞站4號出口。"
    }
  },
  {
    name: "北村韓屋村",
    updates: {
      description: "保存超過600年歷史的傳統韓屋聚落，位於景福宮和昌德宮之間的丘陵地帶。約900棟韓屋中，大部分仍是民居，請尊重住戶隱私保持安靜。「北村八景」是最佳拍照點，狹窄的石板巷弄和傳統瓦房交織出朝鮮時代的古都風情。",
      duration_minutes: 90,
      opening_hours: "24小時（戶外區域），建議10:00-17:00前往",
      tags: ["傳統韓屋", "北村八景", "朝鮮時代", "攝影聖地", "住宅區", "安靜參觀", "韓服體驗", "傳統文化"],
      notes: "免費參觀。請保持安靜，這裡是住宅區。建議穿舒適鞋子（坡道多）。可搭配景福宮、三清洞、仁寺洞一日遊。安國站2號出口步行10分鐘。"
    }
  },
  {
    name: "廣藏市場",
    updates: {
      description: "1905年開業的韓國最早的常設市場，擁有5000多家店鋪。二樓是韓服和絲織品批發區，一樓美食區則是韓國傳統小吃的天堂。必吃綠豆煎餅（빈대떡）、生拌牛肉（육회）、紫菜飯捲（김밥）等道地美食，是首爾最具人情味的市場。",
      duration_minutes: 90,
      opening_hours: "9:00-18:00（美食區至23:00，週日休市）",
      tags: ["百年市場", "韓國最早", "綠豆煎餅", "生拌牛肉", "紫菜飯捲", "麻藥飯捲", "傳統小吃", "庶民美食"],
      notes: "必吃：順熙家綠豆煎餅、元祖麻藥飯捲。美食區現金交易為主。平日下午人較少。週日休市。鐘路5街站8號出口步行3分鐘。"
    }
  },
  // ============================================
  // 泰國 - 曼谷深度景點
  // ============================================
  {
    name: "大皇宮",
    updates: {
      description: "建於1782年的泰國王室宮殿，佔地21.8萬平方公尺，是曼谷最壯觀的建築群。宮內的玉佛寺供奉著翡翠雕成的玉佛，是泰國最神聖的佛像，每年由國王親自為玉佛更換三季法衣。華麗的建築融合泰式、中式和歐式風格，金碧輝煌令人目不暇給。",
      duration_minutes: 150,
      opening_hours: "8:30-16:30（15:30停止入場，國家慶典期間關閉）",
      tags: ["王室宮殿", "玉佛寺", "泰國國寶", "玉佛", "翡翠雕像", "金碧輝煌", "服裝規定", "必訪景點"],
      notes: "門票500泰銖。嚴格服裝規定：長褲/及膝裙、有袖上衣、包覆腳趾鞋。門口可借沙龍。建議8:30開門即入場。搭配臥佛寺、鄭王廟一日遊。"
    }
  },
  {
    name: "恰圖恰週末市集",
    updates: {
      description: "佔地35英畝的世界最大戶外市場之一，超過15000個攤位分為27個區域，販售服飾、手工藝品、古董、植物、寵物等各式商品。迷宮般的巷弄容易迷路，建議先研究地圖。價格可議價，約可殺到7-8折。每週六日及週五夜市開放。",
      duration_minutes: 240,
      opening_hours: "週六日9:00-18:00，週五夜市18:00-24:00",
      tags: ["世界最大市場", "15000攤位", "議價", "服飾", "手工藝", "椰子冰淇淋", "週末限定", "挖寶天堂"],
      notes: "穿舒適鞋子和透氣衣物，非常熱且走很多路。必嚐：椰子冰淇淋、芒果糯米。帶現金，可議價。Section 2-4服飾、7藝術、17植物。MRT恰圖恰公園站。"
    }
  },
  {
    name: "臥佛寺",
    updates: {
      description: "建於1788年的曼谷最大最古老的寺廟，供奉全泰國最大的臥佛，長46公尺、高15公尺，全身覆蓋金箔，腳底雕有108個吉祥圖案。寺廟同時是泰式按摩的發源地，設有按摩學校和服務中心。院內有91座佛塔，建築細節華麗精緻。",
      duration_minutes: 90,
      opening_hours: "8:00-18:30",
      tags: ["臥佛", "46公尺", "金箔佛像", "泰式按摩發源地", "最古老寺廟", "108吉祥圖", "佛塔群", "按摩學校"],
      notes: "門票200泰銖。按摩服務另計，30分鐘260泰銖起。請尊重宗教場所，服裝端莊。可投幣108缽求福。距離大皇宮步行5分鐘，建議搭配參觀。"
    }
  },
];

async function main() {
  console.log('開始深度優化景點資料...\n');

  let updated = 0;
  let notFound = 0;

  for (const item of deepAttractions) {
    // 用名稱找到該景點
    const { data, error } = await supabase
      .from('attractions')
      .select('id, name')
      .eq('name', item.name)
      .single();

    if (error || !data) {
      console.log(`找不到景點: ${item.name}`);
      notFound++;
      continue;
    }

    // 更新景點資料
    const { error: updateError } = await supabase
      .from('attractions')
      .update(item.updates)
      .eq('id', data.id);

    if (updateError) {
      console.log(`更新失敗: ${item.name} - ${updateError.message}`);
    } else {
      console.log(`✓ 已更新: ${item.name}`);
      updated++;
    }
  }

  console.log(`\n完成！更新: ${updated} 筆, 未找到: ${notFound} 筆`);
}

main().catch(console.error);
