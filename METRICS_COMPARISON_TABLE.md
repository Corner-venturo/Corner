# Venturo 專案指標對比表 📋

**基準日期**: 2025-10-26 | **檢查日期**: 2025-10-28 | **間隔**: 2 天

---

## 📊 核心指標總覽

| 類別         | 指標             | 2025-10-26 | 2025-10-28   | 變化量  | 變化率 | 趨勢   | 狀態        |
| ------------ | ---------------- | ---------- | ------------ | ------- | ------ | ------ | ----------- |
| **總體**     | 健康評分         | 6.75/10    | **7.35/10**  | +0.60   | +8.9%  | ⬆️⬆️   | ✅ 改善     |
|              | 代碼行數         | 86,068     | **100,141**  | +14,073 | +16.4% | ⬆️⬆️⬆️ | 🔴 膨脹     |
|              | 檔案總數         | 489        | **533**      | +44     | +9.0%  | ⬆️     | 🟡 正常     |
|              | 專案大小         | 2.8 MB     | **5.3 MB**   | +2.5 MB | +89%   | ⬆️⬆️⬆️ | 🔴 激增     |
|              | 頁面數量         | 51         | **52**       | +1      | +2.0%  | ⬆️     | ✅ 穩定     |
| **架構**     | Service Layer    | 5 個       | **15 個**    | +10     | +200%  | ⬆️⬆️⬆️ | ✅ 優秀     |
|              | Service 代碼     | ~400 行    | **1,558 行** | +1,158  | +290%  | ⬆️⬆️⬆️ | ✅ 質的飛躍 |
|              | API Routes       | 4 個       | **6 個**     | +2      | +50%   | ⬆️     | ✅ 改善     |
|              | Feature 模組     | 11 個      | **11 個**    | 0       | 0%     | ─      | ✅ 穩定     |
|              | Core Services    | 0 個       | **1 個**     | +1      | +100%  | ⬆️     | ✅ 新增     |
| **代碼品質** | 超大檔案 (>500)  | 23 個      | **29 個**    | +6      | +26%   | ⬆️⬆️   | 🔴 惡化     |
|              | 超級大 (>1000)   | 2 個       | **6 個**     | +4      | +200%  | ⬆️⬆️⬆️ | 🔴 嚴重     |
|              | 型別繞過         | 188 個     | **216 個**   | +28     | +14.9% | ⬆️     | 🔴 惡化     |
|              | Console.log      | ~300 個    | **631 個**   | +331    | +110%  | ⬆️⬆️⬆️ | 🔴 嚴重     |
|              | TODO/FIXME       | ~30 個     | **17 個**    | -13     | -43%   | ⬇️⬇️   | ✅ 改善     |
|              | @deprecated      | N/A        | **7 個**     | +7      | +100%  | ⬆️     | ✅ 良好     |
| **測試**     | 測試檔案         | 0 個       | **2 個**     | +2      | +100%  | ⬆️     | ✅ 起步     |
|              | 測試覆蓋率       | ~0%        | **< 1%**     | +0.x%   | +x%    | ⬆️     | 🟡 初期     |
|              | Service 測試     | 0%         | **0%**       | 0%      | 0%     | ─      | 🔴 缺失     |
|              | Store 測試       | 0%         | **11%**      | +11%    | +100%  | ⬆️     | 🟡 起步     |
| **效能**     | React.memo       | N/A        | **14 個**    | +14     | +100%  | ⬆️     | 🟡 不足     |
|              | useMemo/Callback | N/A        | **378 個**   | +378    | +100%  | ⬆️     | ✅ 良好     |
|              | List Virtual     | ❌         | **❌**       | 0       | 0%     | ─      | 🔴 未實作   |

---

## 📂 目錄結構對比

| 目錄                | 2025-10-26       | 2025-10-28           | 變化  | 變化率 | 檔案變化 | 狀態    |
| ------------------- | ---------------- | -------------------- | ----- | ------ | -------- | ------- |
| **src/components/** | 1.6M (185 files) | **1.8M (191 files)** | +200K | +12.5% | +6       | ✅ 正常 |
| **src/app/**        | 768K (51 pages)  | **920K (52 pages)**  | +152K | +19.8% | +1       | 🟡 快速 |
| **src/features/**   | 560K (88 files)  | **596K (91 files)**  | +36K  | +6.4%  | +3       | ✅ 穩定 |
| **src/stores/**     | 312K (36 files)  | **396K (18 files)**  | +84K  | +26.9% | -18\*    | 🟡 重組 |
| **src/lib/**        | 404K (29 files)  | **540K (53 files)**  | +136K | +33.7% | +24      | 🟡 擴展 |
| **src/services/**   | 40K (5 files)    | **36K (4 files)**    | -4K   | -10%   | -1       | ✅ 遷移 |
| **src/hooks/**      | 104K (18 files)  | **108K (20 files)**  | +4K   | +3.8%  | +2       | ✅ 穩定 |
| **src/types/**      | 108K (20 files)  | **N/A**              | N/A   | N/A    | N/A      | -       |

\*註：stores 檔案數減少可能是統計方式不同（workspace/ 子目錄）

---

## 📏 檔案大小分布對比

| 檔案大小範圍    | 2025-10-26    | 2025-10-28      | 變化 | 變化率 | 評級        |
| --------------- | ------------- | --------------- | ---- | ------ | ----------- |
| **< 100 行**    | 247 (50.5%)   | **218 (40.9%)** | -29  | -11.7% | 🔴 比例下降 |
| **100-200 行**  | 134 (27.4%)   | **139 (26.1%)** | +5   | +3.7%  | ✅ 穩定     |
| **200-300 行**  | 56 (11.5%)    | **89 (16.7%)**  | +33  | +58.9% | 🟡 增加     |
| **300-400 行**  | 25 (5.1%)     | **25 (4.7%)**   | 0    | 0%     | ✅ 穩定     |
| **400-500 行**  | 12 (2.5%)     | **16 (3.0%)**   | +4   | +33.3% | 🟡 增加     |
| **500-700 行**  | 17 (3.5%)     | **19 (3.6%)**   | +2   | +11.8% | 🟡 增加     |
| **700-1000 行** | 4 (0.8%)      | **4 (0.8%)**    | 0    | 0%     | ⚪ 持平     |
| **> 1000 行**   | 2 (0.4%)      | **6 (1.1%)**    | +4   | +200%  | 🔴 嚴重惡化 |
| **總計 > 500**  | **23 (4.7%)** | **29 (5.4%)**   | +6   | +26.1% | 🔴 惡化     |

---

## 🚨 超大檔案詳細對比

### 超級大檔案 (>1000 行)

| 檔案                                | 2025-10-26 | 2025-10-28   | 變化          | 狀態        | 優先級 |
| ----------------------------------- | ---------- | ------------ | ------------- | ----------- | ------ |
| **TourPage.tsx**                    | 897 行     | **1,194 行** | +297 (+33%)   | 🔴 持續膨脹 | P0     |
| **attractions/page.tsx**            | N/A        | **1,101 行** | +1,101 (新增) | 🔴 新增     | P0     |
| **regions/page.tsx**                | N/A        | **1,037 行** | +1,037 (新增) | 🔴 新增     | P0     |
| **visas/page.tsx**                  | N/A        | **1,002 行** | +1,002 (新增) | 🔴 新增     | P0     |
| **lib/supabase/types.ts**           | N/A        | **3,773 行** | -             | ✅ 自動生成 | 低     |
| **lib/types/supabase-generated.ts** | N/A        | **2,856 行** | -             | ✅ 自動生成 | 低     |

### 極大檔案 (700-1000 行)

| 檔案                            | 2025-10-26 | 2025-10-28 | 變化        | 狀態        |
| ------------------------------- | ---------- | ---------- | ----------- | ----------- |
| **ChannelSidebar.tsx**          | 833 行     | **847 行** | +14 (+1.7%) | 🟡 持續增長 |
| **todo-expanded-view.tsx**      | 777 行     | **777 行** | 0           | ⚪ 持平     |
| **quotes/page.tsx**             | 695 行     | **756 行** | +61 (+8.8%) | 🟡 增長     |
| **react-datasheet-wrapper.tsx** | 708 行     | **708 行** | 0           | ⚪ 持平     |

### 大檔案 (500-700 行) - 前 10 名

| 檔案                      | 行數 | 狀態      | 註記              |
| ------------------------- | ---- | --------- | ----------------- |
| **create-store.ts**       | 697  | 🔴 應刪除 | 舊版，僅 2 處引用 |
| **QuickTools.tsx**        | 665  | 🟡 需關注 | -                 |
| **channels-store.ts**     | 646  | 🟡 需關注 | -                 |
| **disbursement/page.tsx** | 630  | 🟡 需關注 | -                 |
| **lib/db/schemas.ts**     | 630  | ✅ 可接受 | 資料結構定義      |
| **stores/types.ts**       | 623  | ✅ 可接受 | 型別定義          |
| **basic-info-tab.tsx**    | 615  | 🟡 需關注 | -                 |
| **ChannelChat.tsx**       | 611  | 🟡 需關注 | -                 |
| **PersonalCanvas.tsx**    | 599  | 🟡 需關注 | -                 |
| **enhanced-table.tsx**    | 599  | ✅ 可接受 | 通用組件          |

---

## 🏗️ Service Layer 詳細對比

### Services 數量與分布

| 類別                   | 2025-10-26 | 2025-10-28 | 變化    | 說明                                                                  |
| ---------------------- | ---------- | ---------- | ------- | --------------------------------------------------------------------- |
| **Feature Services**   | 0 個       | **9 個**   | +9      | accounting, customer, order, payments(2), quote, supplier, todo, tour |
| **Core Services**      | 0 個       | **1 個**   | +1      | base.service.ts                                                       |
| **Auth Services**      | 3 個       | **3 個**   | 0       | auth-v5, local-auth, offline-auth                                     |
| **Sync Services**      | 0 個       | **2 個**   | +2      | background-sync, sync-status                                          |
| **Workspace Services** | 2 個       | **0 個**   | -2      | 遷移至 features/                                                      |
| **總計**               | **5 個**   | **15 個**  | **+10** | **+200%**                                                             |

### Feature Services 詳細

| Service                           | 行數         | 主要功能      | 狀態      |
| --------------------------------- | ------------ | ------------- | --------- |
| **accounting.service.ts**         | 147          | 會計資料 CRUD | ✅ 完整   |
| **customer.service.ts**           | 93           | 客戶管理      | ✅ 完整   |
| **order.service.ts**              | 69           | 訂單管理      | ✅ 完整   |
| **payment-request.service.ts**    | 211          | 付款請求      | ✅ 完整   |
| **disbursement-order.service.ts** | 260          | 撥款單        | ✅ 完整   |
| **quote.service.ts**              | 123          | 報價單管理    | ✅ 完整   |
| **supplier.service.ts**           | 241          | 供應商管理    | ✅ 完整   |
| **todo.service.ts**               | 95           | 待辦事項      | ✅ 完整   |
| **tour.service.ts**               | 305          | 旅遊團管理    | ✅ 完整   |
| **總計**                          | **1,544 行** | -             | ✅ 高品質 |

---

## 🧪 測試基礎設施對比

### 測試配置

| 項目           | 2025-10-26 | 2025-10-28          | 狀態 |
| -------------- | ---------- | ------------------- | ---- |
| **測試框架**   | ❌         | ✅ Vitest           | 新增 |
| **配置檔案**   | ❌         | ✅ vitest.config.ts | 新增 |
| **Setup 檔案** | ❌         | ✅ vitest.setup.ts  | 新增 |
| **Storybook**  | ❌         | ✅ 初始化           | 新增 |
| **Stories**    | 0 個       | **4 個**            | +4   |

### 測試覆蓋詳情

| 類別           | 檔案數   | 測試數 | 覆蓋率   | 狀態    |
| -------------- | -------- | ------ | -------- | ------- |
| **Services**   | 15       | 0      | 0%       | 🔴 缺失 |
| **Stores**     | 18       | 2      | 11%      | 🟡 起步 |
| **Components** | 191      | 0      | 0%       | 🔴 缺失 |
| **Hooks**      | 20       | 0      | 0%       | 🔴 缺失 |
| **Utils**      | ~30      | 0      | 0%       | 🔴 缺失 |
| **總計**       | **~274** | **2**  | **< 1%** | 🔴 極低 |

---

## 📚 文檔完整度對比

### 文檔數量

| 類別              | 2025-10-26 | 2025-10-28 | 變化 | 說明             |
| ----------------- | ---------- | ---------- | ---- | ---------------- |
| **根目錄 MD**     | ~30 個     | **43 個**  | +13  | 架構、優化、報告 |
| **docs/**         | ~20 個     | **39 個**  | +19  | 詳細文檔         |
| **architecture/** | ~5 個      | **8 個**   | +3   | 架構設計         |
| **reports/**      | ~5 個      | **9 個**   | +4   | 技術報告         |
| **refactoring/**  | ~3 個      | **N/A**    | -    | 重構記錄         |
| **README.md**     | ✅         | ✅         | -    | 專案總覽         |

### 文檔品質

| 文檔類型     | 完整度 | 更新頻率 | 品質    |
| ------------ | ------ | -------- | ------- |
| **架構文檔** | 80%    | 每週     | ✅ 優秀 |
| **API 文檔** | 30%    | 少量     | 🔴 缺失 |
| **組件文檔** | 20%    | 少量     | 🔴 缺失 |
| **開發指南** | 60%    | 每月     | 🟡 中等 |
| **測試指南** | 10%    | 少量     | 🔴 缺失 |

---

## 🎯 健康評分細項對比

| 指標              | 權重     | 2025-10-26    | 2025-10-28    | 變化      | 貢獻      | 趨勢     |
| ----------------- | -------- | ------------- | ------------- | --------- | --------- | -------- |
| **架構設計**      | 20%      | 8.0/10 (1.60) | 8.5/10 (1.70) | +0.5      | +0.10     | ⬆️       |
| **代碼組織**      | 15%      | 7.0/10 (1.05) | 6.5/10 (0.98) | -0.5      | -0.07     | ⬇️       |
| **型別安全**      | 15%      | 6.0/10 (0.90) | 5.5/10 (0.83) | -0.5      | -0.07     | ⬇️       |
| **狀態管理**      | 15%      | 8.0/10 (1.20) | 8.0/10 (1.20) | 0         | 0         | ─        |
| **可重用性**      | 10%      | 7.0/10 (0.70) | 7.0/10 (0.70) | 0         | 0         | ─        |
| **測試覆蓋**      | 10%      | 2.0/10 (0.20) | 2.5/10 (0.25) | +0.5      | +0.05     | ⬆️       |
| **文檔完整**      | 5%       | 3.0/10 (0.15) | 5.0/10 (0.25) | +2.0      | +0.10     | ⬆️⬆️     |
| **效能優化**      | 5%       | 5.0/10 (0.25) | 5.5/10 (0.28) | +0.5      | +0.03     | ⬆️       |
| **Service Layer** | 5%       | 3.0/10 (0.15) | 8.0/10 (0.40) | +5.0      | +0.25     | ⬆️⬆️⬆️   |
| **總分**          | **100%** | **6.75/10**   | **7.35/10**   | **+0.60** | **+0.60** | **⬆️⬆️** |

**最大貢獻**: Service Layer (+0.25 分，+166% 相對貢獻)
**最大損失**: 代碼組織、型別安全 (各 -0.07 分)

---

## 📊 技術債務對比

### 代碼異味 (Code Smells)

| 類型              | 2025-10-26 | 2025-10-28 | 變化         | 嚴重度  |
| ----------------- | ---------- | ---------- | ------------ | ------- |
| **as any**        | 43 個      | **43 個**  | 0            | 🔴 高   |
| **as unknown**    | 145 個     | **173 個** | +28 (+19%)   | 🔴 高   |
| **console.log**   | ~300 個    | **631 個** | +331 (+110%) | 🟡 中   |
| **console.warn**  | 包含上方   | 包含上方   | -            | 🟡 中   |
| **console.error** | 包含上方   | 包含上方   | -            | ✅ 低   |
| **TODO**          | ~25 個     | **15 個**  | -10          | ✅ 改善 |
| **FIXME**         | ~5 個      | **2 個**   | -3           | ✅ 改善 |
| **HACK**          | ~2 個      | **0 個**   | -2           | ✅ 清除 |

### 架構問題

| 問題                       | 狀態 (10/26) | 狀態 (10/28) | 改善      |
| -------------------------- | ------------ | ------------ | --------- |
| **create-store.ts 重複**   | 🔴 存在      | 🔴 仍存在    | ❌ 未解決 |
| **Workspace Store Facade** | 🟡 耦合      | 🟡 耦合      | ─ 持平    |
| **Service Layer 薄弱**     | 🔴 僅 5 個   | ✅ 15 個     | ✅ 已解決 |
| **API Layer 不足**         | 🟡 4 個      | 🟡 6 個      | 🟢 改善中 |
| **測試缺失**               | 🔴 0%        | 🔴 < 1%      | 🟢 起步   |

---

## 🚀 新增功能評估

### 新頁面

| 頁面                     | 行數  | 組件數 | Hooks | 狀態    | 業務價值 | 技術債 |
| ------------------------ | ----- | ------ | ----- | ------- | -------- | ------ |
| **visas/page.tsx**       | 1,002 | 2      | 4     | 🔴 過大 | ✅ 高    | 🔴 高  |
| **attractions/page.tsx** | 1,101 | 0      | 0     | 🔴 過大 | ✅ 高    | 🔴 高  |
| **regions/page.tsx**     | 1,037 | 0      | 0     | 🔴 過大 | ✅ 高    | 🔴 高  |
| **contracts/page.tsx**   | 197   | 4      | 0     | ✅ 合理 | ✅ 高    | ✅ 低  |

**總評**:

- ✅ 功能豐富，快速交付
- 🔴 3 個頁面嚴重超標
- 🔧 需要立即重構

---

## 🎯 目標達成度

### 短期目標 (2 週)

| 目標               | 計劃   | 實際   | 達成率 | 狀態        |
| ------------------ | ------ | ------ | ------ | ----------- |
| Service Layer 擴展 | 5 → 12 | 5 → 15 | 125%   | ✅ 超額完成 |
| API Routes 擴展    | 4 → 10 | 4 → 6  | 60%    | 🟡 進行中   |
| 測試基礎設施       | 建立   | 建立   | 100%   | ✅ 完成     |
| 拆分超大檔案       | 3 個   | 0 個   | 0%     | 🔴 未開始   |
| 刪除 create-store  | 是     | 否     | 0%     | 🔴 未完成   |

### 長期目標 (3 個月)

| 目標       | 當前 | 目標  | 進度 | 預估達成  |
| ---------- | ---- | ----- | ---- | --------- |
| 健康評分   | 7.35 | 8.5   | 65%  | 🟡 有可能 |
| 測試覆蓋率 | < 1% | 40%   | 2%   | 🔴 落後   |
| 超大檔案   | 29   | < 10  | 0%   | 🔴 惡化   |
| 型別繞過   | 216  | < 100 | 0%   | 🔴 惡化   |
| Service 數 | 15   | 15-20 | 75%  | ✅ 接近   |

---

## 📈 關鍵趨勢分析

### 代碼增長速度

| 期間          | 增長量     | 日均增長     | 評估        |
| ------------- | ---------- | ------------ | ----------- |
| 10/26 → 10/28 | +14,073 行 | +7,037 行/日 | 🔴 過快     |
| 預估 11/28    | +50,000 行 | +1,667 行/日 | 🔴 不可持續 |

### 品質下降速度

| 指標        | 變化速度   | 預估 1 個月後 | 風險    |
| ----------- | ---------- | ------------- | ------- |
| 超大檔案    | +3 個/日   | 119 個        | 🔴 極高 |
| 型別繞過    | +14 個/日  | 636 個        | 🔴 極高 |
| Console.log | +165 個/日 | 5,581 個      | 🔴 極高 |

**結論**: 如果不立即採取行動，1 個月後代碼將難以維護

---

## 🎬 總結與建議

### ✅ 做得好的地方

1. **Service Layer 建立** - 200% 增長，架構升級
2. **測試基礎設施** - Vitest + Storybook 就緒
3. **功能交付速度** - 4 個新頁面，業務價值高
4. **文檔改善** - 新增 32 個文檔

### 🔴 需要立即改善

1. **超大檔案激增** - 29 個 (+26%)，4 個超過 1000 行
2. **Console.log 氾濫** - 631 個 (+110%)
3. **型別繞過增加** - 216 個 (+15%)
4. **create-store.ts** - 仍未刪除

### 🎯 下週行動計劃

**P0 - 必須完成**:

1. [ ] 刪除 create-store.ts (0.5h)
2. [ ] 清理 Console.log → 50 個 (2h)
3. [ ] 拆分 4 個超大頁面 (12-16h)

**預期成果**:

- 健康評分 → 7.8/10
- 超大檔案 → 19 個
- 技術債務 -40%

---

**報告版本**: v2.0
**生成時間**: 2025-10-28
**下次更新**: 2025-11-04
