
[36m╔════════════════════════════════════════════════════════════╗
║                                                            ║
║          Venturo 程式碼品質分析工具 v1.0                    ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝[0m
  

[36m============================================================[0m
[36m掃描大型檔案 (>500 行)[0m
[36m============================================================[0m

[31m❌ src/app/quotes/[id]/page.tsx: 1944 行 (超過 1000 行！)[0m
[31m❌ src/app/tours/page.tsx: 1650 行 (超過 1000 行！)[0m
[31m❌ src/stores/workspace-store.ts: 1410 行 (超過 1000 行！)[0m
[31m❌ src/components/workspace/ChannelChat.tsx: 1393 行 (超過 1000 行！)[0m
[31m❌ src/app/finance/requests/page.tsx: 1135 行 (超過 1000 行！)[0m
[31m❌ src/app/page.tsx: 1109 行 (超過 1000 行！)[0m
[31m❌ src/app/calendar/page.tsx: 1075 行 (超過 1000 行！)[0m
[31m❌ src/components/editor/TourForm.tsx: 1074 行 (超過 1000 行！)[0m
[33m⚠️  src/components/TourPage.tsx: 897 行[0m
[33m⚠️  src/components/todos/todo-expanded-view.tsx: 777 行[0m
[33m⚠️  src/lib/db/index.ts: 735 行[0m
[33m⚠️  src/components/shared/react-datasheet-wrapper.tsx: 708 行[0m
[33m⚠️  src/stores/create-store.ts: 696 行[0m
[33m⚠️  src/app/visas/page.tsx: 676 行[0m
[33m⚠️  src/components/workspace/QuickTools.tsx: 665 行[0m
[33m⚠️  src/app/finance/treasury/disbursement/page.tsx: 631 行[0m
[33m⚠️  src/lib/db/schemas.ts: 630 行[0m
[33m⚠️  src/components/hr/tabs/basic-info-tab.tsx: 615 行[0m
[33m⚠️  src/stores/types.ts: 603 行[0m
[34mℹ️  找到 19 個大型檔案
[0m

[36m============================================================[0m
[36m掃描型別逃逸 (as unknown)[0m
[36m============================================================[0m

[33m⚠️  src/app/settings/page.tsx: 3 處型別逃逸[0m
[33m⚠️  src/app/database/regions/page.tsx: 1 處型別逃逸[0m
[33m⚠️  src/app/database/transport/page.tsx: 1 處型別逃逸[0m
[33m⚠️  src/app/database/suppliers/page.tsx: 1 處型別逃逸[0m
[33m⚠️  src/app/database/activities/page.tsx: 1 處型別逃逸[0m
[33m⚠️  src/app/tours/page.tsx: 2 處型別逃逸[0m
[31m❌ src/app/quotes/[id]/page.tsx: 9 處型別逃逸[0m
[33m⚠️  src/app/quotes/page.tsx: 3 處型別逃逸[0m
[33m⚠️  src/app/visas/page.tsx: 2 處型別逃逸[0m
[33m⚠️  src/app/hr/page.tsx: 4 處型別逃逸[0m
[33m⚠️  src/app/finance/requests/page.tsx: 3 處型別逃逸[0m
[33m⚠️  src/app/finance/treasury/disbursement/page.tsx: 2 處型別逃逸[0m
[33m⚠️  src/app/finance/travel-invoice/create/page.tsx: 1 處型別逃逸[0m
[33m⚠️  src/app/orders/[orderId]/payment/page.tsx: 2 處型別逃逸[0m
[33m⚠️  src/app/orders/page.tsx: 2 處型別逃逸[0m
[33m⚠️  src/app/todos/page.tsx: 2 處型別逃逸[0m
[33m⚠️  src/features/customers/hooks/useCustomers.ts: 1 處型別逃逸[0m
[33m⚠️  src/features/customers/services/customer.service.ts: 1 處型別逃逸[0m
[33m⚠️  src/features/accounting/services/accounting.service.ts: 4 處型別逃逸[0m
[33m⚠️  src/features/payments/hooks/usePayments.ts: 1 處型別逃逸[0m
[33m⚠️  src/features/payments/services/disbursement-order.service.ts: 2 處型別逃逸[0m
[33m⚠️  src/features/payments/services/payment-request.service.ts: 2 處型別逃逸[0m
[33m⚠️  src/features/tours/hooks/useTours.ts: 1 處型別逃逸[0m
[31m❌ src/features/tours/services/tour.service.ts: 7 處型別逃逸[0m
[33m⚠️  src/features/suppliers/services/supplier.service.ts: 1 處型別逃逸[0m
[33m⚠️  src/features/quotes/hooks/useQuotes.ts: 1 處型別逃逸[0m
[33m⚠️  src/features/quotes/services/quote.service.ts: 2 處型別逃逸[0m
[33m⚠️  src/features/orders/hooks/useOrders.ts: 2 處型別逃逸[0m
[33m⚠️  src/features/orders/services/order.service.ts: 1 處型別逃逸[0m
[33m⚠️  src/features/todos/services/todo.service.ts: 2 處型別逃逸[0m
[33m⚠️  src/stores/timebox-store-supabase.ts: 1 處型別逃逸[0m
[33m⚠️  src/stores/index.ts: 1 處型別逃逸[0m
[33m⚠️  src/components/accounting/transaction-list.tsx: 2 處型別逃逸[0m
[33m⚠️  src/components/accounting/add-account-dialog.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/accounting/add-transaction-dialog.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/ui/calendar.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/ui/checkbox.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/tours/tour-costs.tsx: 4 處型別逃逸[0m
[33m⚠️  src/components/tours/tour-payments.tsx: 3 處型別逃逸[0m
[31m❌ src/components/tours/tour-members.tsx: 12 處型別逃逸[0m
[33m⚠️  src/components/workspace/QuickTools.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/workspace/ShareAdvanceDialog.tsx: 2 處型別逃逸[0m
[33m⚠️  src/components/workspace/CreatePaymentRequestDialog.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/workspace/BulletinBoard.tsx: 2 處型別逃逸[0m
[33m⚠️  src/components/workspace/workspace-task-list.tsx: 3 處型別逃逸[0m
[33m⚠️  src/components/workspace/CreateReceiptDialog.tsx: 2 處型別逃逸[0m
[33m⚠️  src/components/workspace/channel-list.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/workspace/canvas-view.tsx: 2 處型別逃逸[0m
[31m❌ src/components/hr/tabs/permissions-tab.tsx: 7 處型別逃逸[0m
[33m⚠️  src/components/hr/tabs/basic-info-tab.tsx: 5 處型別逃逸[0m
[33m⚠️  src/components/hr/employee-expanded-view.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/hr/add-employee-form.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/templates/template-pdf-preview.tsx: 2 處型別逃逸[0m
[33m⚠️  src/components/templates/template-card.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/templates/template-editor-dialog.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/templates/field-mapping-editor.tsx: 1 處型別逃逸[0m
[33m⚠️  src/components/finance/batch-receipt-dialog.tsx: 2 處型別逃逸[0m
[33m⚠️  src/components/members/excel-member-table.tsx: 1 處型別逃逸[0m
[31m❌ src/components/orders/add-order-form.tsx: 6 處型別逃逸[0m
[33m⚠️  src/components/orders/order-kanban.tsx: 1 處型別逃逸[0m
[33m⚠️  src/hooks/useCrudOperations.ts: 1 處型別逃逸[0m
[33m⚠️  src/lib/cache/cache-strategy.ts: 3 處型別逃逸[0m
[33m⚠️  src/lib/error-handler.ts: 2 處型別逃逸[0m
[33m⚠️  src/lib/supabase/helpers.ts: 2 處型別逃逸[0m
[33m⚠️  src/lib/db/init-local-data.ts: 2 處型別逃逸[0m
[33m⚠️  src/lib/db/database-initializer.ts: 1 處型別逃逸[0m
[33m⚠️  src/lib/db/sync-schema-helper.ts: 1 處型別逃逸[0m
[33m⚠️  src/lib/db/verify-and-fix.ts: 3 處型別逃逸[0m
[33m⚠️  src/lib/performance/memory-manager.ts: 4 處型別逃逸[0m
[33m⚠️  src/lib/store/lazy-store.ts: 3 處型別逃逸[0m
[33m⚠️  src/services/auth-service-v5.ts: 2 處型別逃逸[0m
[33m⚠️  src/services/offline-auth.service.ts: 1 處型別逃逸[0m
[33m⚠️  src/services/local-auth-service.ts: 4 處型別逃逸[0m
[34mℹ️  找到 73 個檔案使用型別逃逸
[0m

[36m============================================================[0m
[36m掃描 setTimeout 使用[0m
[36m============================================================[0m

[33m⚠️  src/app/accounting/page.tsx:92 - 使用魔法數字[0m
[34mℹ️  src/app/accounting/page.tsx:95[0m
[34mℹ️  src/app/accounting/page.tsx:103[0m
[34mℹ️  src/app/database/regions/page.tsx:22[0m
[34mℹ️  src/app/quotes/[id]/page.tsx:289[0m
[33m⚠️  src/app/quotes/[id]/page.tsx:907 - 使用魔法數字[0m
[34mℹ️  src/app/quotes/page.tsx:40[0m
[34mℹ️  src/app/fix-database/page.tsx:318[0m
[34mℹ️  src/app/timebox/components/box-dialogs/workout-dialog.tsx:69[0m
[34mℹ️  src/app/timebox/components/box-dialogs/workout-dialog.tsx:95[0m
[34mℹ️  src/app/timebox/components/box-dialogs/workout-dialog.tsx:112[0m
[33m⚠️  src/app/finance/requests/page.tsx:491 - 使用魔法數字[0m
[33m⚠️  src/app/finance/requests/page.tsx:534 - 使用魔法數字[0m
[33m⚠️  src/app/finance/requests/page.tsx:819 - 使用魔法數字[0m
[34mℹ️  src/app/itinerary/new/page.tsx:255[0m
[33m⚠️  src/stores/create-store.ts:178 - 使用魔法數字[0m
[33m⚠️  src/stores/create-store.ts:225 - 使用魔法數字[0m
[34mℹ️  src/stores/create-store.ts:257[0m
[33m⚠️  src/stores/create-store.ts:318 - 使用魔法數字[0m
[34mℹ️  src/stores/create-store.ts:449[0m
[34mℹ️  src/stores/create-store.ts:512[0m
[34mℹ️  src/stores/create-store.ts:572[0m
[34mℹ️  src/stores/accounting-store.ts:399[0m
[34mℹ️  src/stores/operations/create.ts:59[0m
[34mℹ️  src/stores/operations/update.ts:53[0m
[34mℹ️  src/stores/operations/fetch.ts:74[0m
[34mℹ️  src/stores/operations/delete.ts:54[0m
[34mℹ️  src/stores/adapters/indexeddb-adapter.ts:21[0m
[34mℹ️  src/stores/adapters/indexeddb-adapter.ts:98[0m
[33m⚠️  src/stores/workspace-store.ts:473 - 使用魔法數字[0m
[34mℹ️  src/stores/workspace-store.ts:530[0m
[34mℹ️  src/stores/workspace-store.ts:645[0m
[33m⚠️  src/stores/workspace-store.ts:1385 - 使用魔法數字[0m
[33m⚠️  src/components/ui/thursday-date-picker.tsx:58 - 使用魔法數字[0m
[33m⚠️  src/components/ui/smart-date-input.tsx:64 - 使用魔法數字[0m
[33m⚠️  src/components/ui/smart-date-input.tsx:86 - 使用魔法數字[0m
[34mℹ️  src/components/tours/tour-operations.tsx:168[0m
[34mℹ️  src/components/tours/tour-members.tsx:91[0m
[33m⚠️  src/components/manifestation/ChapterContent.tsx:84 - 使用魔法數字[0m
[34mℹ️  src/components/manifestation/BreathingExercise.tsx:20[0m
[34mℹ️  src/components/layout/main-layout.tsx:40[0m
[34mℹ️  src/components/layout/sidebar.tsx:190[0m
[33m⚠️  src/components/workspace/ChannelChat.tsx:285 - 使用魔法數字[0m
[34mℹ️  src/components/workspace/ChannelChat.tsx:637[0m
[33m⚠️  src/components/workspace/ChannelChat.tsx:641 - 使用魔法數字[0m
[34mℹ️  src/components/TourPage.tsx:53[0m
[34mℹ️  src/components/TourPage.tsx:131[0m
[33m⚠️  src/components/hr/tabs/permissions-tab.tsx:116 - 使用魔法數字[0m
[33m⚠️  src/components/hr/tabs/permissions-tab.tsx:157 - 使用魔法數字[0m
[33m⚠️  src/components/hr/add-employee-form.tsx:132 - 使用魔法數字[0m
[33m⚠️  src/components/sync/sync-status-indicator.tsx:90 - 使用魔法數字[0m
[33m⚠️  src/components/sync/sync-status-indicator.tsx:96 - 使用魔法數字[0m
[33m⚠️  src/components/sync/sync-status-indicator.tsx:116 - 使用魔法數字[0m
[33m⚠️  src/lib/supabase/client.ts:25 - 使用魔法數字[0m
[34mℹ️  src/lib/db/index.ts:172[0m
[33m⚠️  src/lib/db/version-manager.ts:95 - 使用魔法數字[0m
[34mℹ️  src/lib/files.ts:7[0m
[34mℹ️  找到 57 處 setTimeout 使用
[0m

[36m============================================================[0m
[36m掃描潛在記憶體洩漏[0m
[36m============================================================[0m

[32m✅ src/app/quotes/[id]/page.tsx:299 - 有清理邏輯[0m
[32m✅ src/app/timebox/components/scheduled-box-item.tsx:37 - 有清理邏輯[0m
[32m✅ src/app/itinerary/new/page.tsx:247 - 有清理邏輯[0m
[32m✅ src/app/itinerary/[slug]/page.tsx:97 - 有清理邏輯[0m
[32m✅ src/stores/create-store.ts:689 - 有清理邏輯[0m
[32m✅ src/components/ui/date-picker.tsx:113 - 有清理邏輯[0m
[32m✅ src/components/ui/combobox.tsx:236 - 有清理邏輯[0m
[32m✅ src/components/ui/dropdown-menu.tsx:100 - 有清理邏輯[0m
[32m✅ src/components/sync-status-badge.tsx:37 - 有清理邏輯[0m
[32m✅ src/components/sync-status-badge.tsx:38 - 有清理邏輯[0m
[32m✅ src/components/workspace/ChannelChat.tsx:610 - 有清理邏輯[0m
[32m✅ src/components/shared/react-datasheet-wrapper.tsx:142 - 有清理邏輯[0m
[32m✅ src/components/shared/react-datasheet-wrapper.tsx:143 - 有清理邏輯[0m
[32m✅ src/components/TourPage.tsx:58 - 有清理邏輯[0m
[32m✅ src/components/TourPage.tsx:136 - 有清理邏輯[0m
[32m✅ src/components/templates/template-excel-editor.tsx:122 - 有清理邏輯[0m
[32m✅ src/components/ErrorLogger.tsx:72 - 有清理邏輯[0m
[32m✅ src/components/ErrorLogger.tsx:73 - 有清理邏輯[0m
[32m✅ src/components/sync/sync-status-indicator.tsx:56 - 有清理邏輯[0m
[32m✅ src/components/sync/sync-status-indicator.tsx:57 - 有清理邏輯[0m
[32m✅ src/components/sync/sync-status-indicator.tsx:99 - 有清理邏輯[0m
[32m✅ src/components/sync/sync-status-indicator.tsx:100 - 有清理邏輯[0m
[32m✅ src/components/widgets/calculator/useCalculatorKeyboard.ts:41 - 有清理邏輯[0m
[32m✅ src/components/widgets/calculator/useCalculatorKeyboard.ts:105 - 有清理邏輯[0m
[32m✅ src/lib/auth-guard.tsx:29 - 有清理邏輯[0m
[32m✅ src/lib/auth-guard.tsx:30 - 有清理邏輯[0m
[32m✅ src/lib/sync/network-monitor.ts:15 - 有清理邏輯[0m
[32m✅ src/lib/sync/network-monitor.ts:16 - 有清理邏輯[0m
[31m❌ src/lib/performance/memory-manager.ts:45 - 缺少 removeEventListener[0m
[34mℹ️  檢查了 29 處事件監聽器
[0m

[36m============================================================[0m
[36m掃描 TODO/FIXME 標記[0m
[36m============================================================[0m

[33m⚠️  src/app/customers/page.tsx: 1 處待修復[0m
[33m⚠️  src/app/database/transport/page.tsx: 2 處待修復[0m
[33m⚠️  src/app/database/activities/page.tsx: 2 處待修復[0m
[33m⚠️  src/app/database/page.tsx: 1 處待修復[0m
[33m⚠️  src/app/tours/page.tsx.bak2: 2 處待修復[0m
[33m⚠️  src/app/tours/[id]/page.tsx: 5 處待修復[0m
[33m⚠️  src/app/tours/page.tsx: 4 處待修復[0m
[33m⚠️  src/app/timebox/components/create-box-dialog.tsx: 1 處待修復[0m
[33m⚠️  src/app/templates/[id]/page.tsx: 2 處待修復[0m
[33m⚠️  src/app/finance/payments/new/page.tsx: 1 處待修復[0m
[33m⚠️  src/app/finance/payments/page.tsx: 3 處待修復[0m
[33m⚠️  src/app/finance/treasury/disbursement/page.tsx: 3 處待修復[0m
[33m⚠️  src/app/finance/page.tsx: 2 處待修復[0m
[33m⚠️  src/app/finance/travel-invoice/[id]/page.tsx: 1 處待修復[0m
[33m⚠️  src/app/finance/travel-invoice/create/page.tsx: 1 處待修復[0m
[33m⚠️  src/app/finance/reports/page.tsx: 2 處待修復[0m
[33m⚠️  src/app/orders/[orderId]/payment/page.tsx.bak2: 2 處待修復[0m
[33m⚠️  src/app/orders/[orderId]/payment/page.tsx: 2 處待修復[0m
[33m⚠️  src/app/orders/[orderId]/documents/page.tsx: 1 處待修復[0m
[33m⚠️  src/app/itinerary/page.tsx: 1 處待修復[0m
[33m⚠️  src/features/customers/services/customer.service.ts: 1 處待修復[0m
[33m⚠️  src/features/payments/index.ts: 1 處待修復[0m
[33m⚠️  src/features/payments/services/disbursement-order.service.ts: 1 處待修復[0m
[33m⚠️  src/features/payments/services/payment-request.service.ts: 1 處待修復[0m
[33m⚠️  src/features/tours/services/tour.service.ts: 1 處待修復[0m
[33m⚠️  src/features/index.ts: 1 處待修復[0m
[33m⚠️  src/stores/create-store.ts: 3 處待修復[0m
[33m⚠️  src/stores/timebox-store.ts: 1 處待修復[0m
[33m⚠️  src/stores/auth-store.ts: 1 處待修復[0m
[31m❌ src/stores/index.ts: 8 處待修復[0m
[33m⚠️  src/stores/sync/merge-strategy.ts: 1 處待修復[0m
[33m⚠️  src/components/tours/tour-costs.tsx.bak2: 2 處待修復[0m
[33m⚠️  src/components/tours/tour-costs.tsx: 3 處待修復[0m
[33m⚠️  src/components/tours/tour-payments.tsx: 2 處待修復[0m
[33m⚠️  src/components/workspace/CreatePaymentRequestDialog.tsx: 1 處待修復[0m
[31m❌ src/components/workspace/ChannelChat.tsx: 8 處待修復[0m
[33m⚠️  src/components/workspace/workspace-task-list.tsx: 1 處待修復[0m
[33m⚠️  src/components/workspace/CreateReceiptDialog.tsx: 4 處待修復[0m
[33m⚠️  src/components/workspace/create-channel-dialog.tsx: 2 處待修復[0m
[33m⚠️  src/components/workspace/FinanceAlertCard.tsx: 1 處待修復[0m
[33m⚠️  src/components/workspace/channel-list.tsx: 1 處待修復[0m
[33m⚠️  src/components/workspace/canvas-view.tsx: 1 處待修復[0m
[33m⚠️  src/components/sync-indicator.tsx: 1 處待修復[0m
[33m⚠️  src/components/templates/template-card.tsx: 1 處待修復[0m
[33m⚠️  src/components/templates/use-template-dialog.tsx: 3 處待修復[0m
[33m⚠️  src/components/finance/batch-receipt-dialog.tsx: 1 處待修復[0m
[33m⚠️  src/components/widgets/currency-widget.tsx: 1 處待修復[0m
[33m⚠️  src/components/widgets/calculator-widget.tsx: 1 處待修復[0m
[33m⚠️  src/hooks/index.ts: 1 處待修復[0m
[33m⚠️  src/hooks/useTours.ts: 2 處待修復[0m
[33m⚠️  src/lib/error-handler.ts: 1 處待修復[0m
[33m⚠️  src/lib/logger.ts: 1 處待修復[0m
[33m⚠️  src/lib/db/schemas.ts: 1 處待修復[0m
[33m⚠️  src/services/offline-auth.service.ts: 4 處待修復[0m
[34mℹ️  找到 54 個檔案有 TODO/FIXME
[0m

[36m============================================================[0m
[36m程式碼健康度報告[0m
[36m============================================================[0m

[31m健康度分數: 0.0/100[0m

問題統計：
  🏗️  大型檔案 (>500行): 19 個
  🔓 型別逃逸 (as unknown): 166 處 (73 個檔案)
  ⏰ setTimeout 使用: 57 處
  💾 潛在記憶體洩漏: 1 處
  📝 TODO/FIXME: 103 處 (54 個檔案)

建議：
[31m❌ 程式碼健康度嚴重不足，建議立即重構！[0m

📄 詳細報告已生成：
  - CODE_ISSUES_REPORT.md
  - LOGIC_ISSUES_SUMMARY.md

[32m✅ JSON 報告已儲存: code-quality-report.json
[0m
